1. CORE FUNCTION: flutter_signature_pad
flutter_signature_pad: ^3.0.1
What It Does:

Draws smooth signature on canvas
Exports as ui.Image → Uint8List

Core Code:
final image = await _signKey.currentState!.getData();
final byteData = await image.toByteData(format: ui.ImageByteFormat.png);

This is the heart of the app — never change this

2. ALL PROBLEMS & SOLUTIONS
#ProblemWhy It HappensHow to FixImportance1gallery_saver / image_gallery_saver → Namespace errorOld plugins don't support AGP 8+Use photo_manager: ^3.0.0HIGH2PlatformException(channel-error)No permission / plugin not initializedRequest permission at runtimeHIGH3Black image in GalleryTransparent PNG → photo_manager corrupts itAdd white background before savingCRITICAL4ImageByteFormat.jpeg not foundui.ImageByteFormat only has .pngUse .png onlyMEDIUM5saveImage() → black/corruptedUint8List → metadata lostUse saveImageWithPath()HIGH6Image not in custom folderrelativePath: 'Signatures' → blockedUse Pictures/SignaturesMEDIUM7decodeImageFromList errorWrong usageUse instantiateImageCodecMEDIUM8Temp file not deletedMemory leakawait tempFile.delete();LOW

3. FINAL WORKING FLOW (BEST PRACTICE)
dart1. Draw → getData() → ui.Image
2. toByteData(format: ui.ImageByteFormat.png) → Uint8List
3. Create white canvas → draw signature on it
4. Save to temp file (.png)
5. photo_manager.saveImageWithPath(tempFile.path, relativePath: 'Pictures/Signatures')
6. Delete temp file

4. CRITICAL CODE: Add White Background (Fixes Black Image)
final recorder = ui.PictureRecorder();
final canvas = Canvas(recorder);
final size = Size(image.width.toDouble(), image.height.toDouble());

// White background
canvas.drawColor(Colors.white, BlendMode.color);

// Draw signature
final codec = await ui.instantiateImageCodec(originalBytes);
final frame = await codec.getNextFrame();
canvas.drawImage(frame.image, Offset.zero, Paint());

final picture = recorder.endRecording();
final finalImage = await picture.toImage(image.width, image.height);
final byteData = await finalImage.toByteData(format: ui.ImageByteFormat.png);

This is the #1 fix for black images


5. PERMISSIONS (MUST HAVE)
Android (AndroidManifest.xml)
xml<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="android.permission.READ_MEDIA_IMAGES"/>
iOS (Info.plist)
xml<key>NSPhotoLibraryAddUsageDescription</key>
<string>Save signature to Photos</string>

6. FINAL pubspec.yaml
dependencies:
  flutter:
    sdk: flutter
  flutter_signature_pad: ^3.0.1
  photo_manager: ^3.0.0
  path_provider: ^2.1.1
  permission_handler: ^11.3.1

7. FINAL SAVE PATH

PlatformPathAndroidInternal Storage > Pictures > SignaturesiOSPhotos > Signatures

8. DOs & DON'Ts
DO DON'T Use photo_managerUse gallery_saverUse saveImageWithPath()Use saveImage(Uint8List)Add white backgroundSave transparent PNGUse .pngUse .jpeg (not supported)Use Pictures/SignaturesUse Signatures onlyDelete temp fileLeave temp files

9. ONE-LINE SUMMARY

Draw → Add white background → Save as PNG file → photo_manager.saveImageWithPath() → Gallery (Pictures/Signatures)


10. FINAL CODE SNIPPET (Copy-Paste Ready)
dart// Inside _saveSignature()
final image = await sign.getData();
final originalData = await image.toByteData(format: ui.ImageByteFormat.png);
final bytes = originalData!.buffer.asUint8List();

// White background + signature
final recorder = ui.PictureRecorder();
final canvas = Canvas(recorder);
canvas.drawColor(Colors.white, BlendMode.color);
final codec = await ui.instantiateImageCodec(bytes);
final frame = await codec.getNextFrame();
canvas.drawImage(frame.image, Offset.zero, Paint());
final picture = recorder.endRecording();
final finalImg = await picture.toImage(image.width, image.height);
final finalData = await finalImg.toByteData(format: ui.ImageByteFormat.png);
final buffer = finalData!.buffer.asUint8List();

// Save to file
final fileName = 'sig_${DateTime.now().millisecondsSinceEpoch}.png';
final tempFile = File('${(await getTemporaryDirectory()).path}/$fileName');
await tempFile.writeAsBytes(buffer);

// Save to Gallery
await PhotoManager.editor.saveImageWithPath(
  tempFile.path,
  title: fileName,
  relativePath: 'Pictures/Signatures',
);
await tempFile.delete();